##      GPU     ##

vo=gpu-next
gpu-api=vulkan
gpu-context=waylandvk
hwdec=vaapi

##      Scale     ##

scale=lanczos                       # Luma upscaling
scale-blur=0.9812505644269356
scale-antiring=0.8
dscale=ewa_robidoux                 # Luma downscaling
dscale-param1=0
dscale-param2=0
dscale-antiring=0.8
cscale=lanczos                      # Chroma up+down scaling
cscale-antiring=0.8
sigmoid-upscaling=yes

##      Video     ##

##  video-output-levels=full                        # HDR
##  hdr-peak-percentile=99.995                      # HDR
##  hdr-contrast-recovery=0.30                      # HDR
##  vf=format=colorlevels=full:colormatrix=auto     # HDR
##  target-prim=bt.2020                             # HDR
##  target-colorspace-hint=yes                      # HDR
##  fbo-format=rgba16hf                             # HDR

##  tone-mapping=st2094-40                          # HDR+ --> SDR
tone-mapping=bt.2446a                               # HDR --> SDR
deinterlace=no
hr-seek-framedrop=no
save-position-on-quit=yes
##  no-resume-playback=yes                          # Do not save position on exit
fullscreen=yes
keep-open=yes
reset-on-next-file=audio-delay,mute,pause,speed,sub-delay,video-aspect-override,video-pan-x,video-pan-y,video-rotate,video-zoom,volume
ytdl-format="bestvideo[height<=?1080]+bestaudio/best"

##      Audio     ##

volume=100
volume-max=150
ao=pipewire
audio-file-auto=fuzzy
audio-channels=stereo
af=lavfi=[dynaudnorm=f=250:g=31:p=0.5:m=5:r=0.9:b=1]
alang=ru,rus,russian,en,eng,english,enUS,ukr
##  mute=yes

##      Dither    ##

dither-depth=auto
temporal-dither=yes
dither=fruit

##      Debanding       ##

deband=yes
deband-iterations=4
deband-threshold=35
deband-range=16
deband-grain=5

##      UI      ##

osc=no
osd-font='Carlito Bold'
osd-font-size=32
osd-duration=1500
osd-bar-align-x=0
osd-bar-align-y=1
osd-bar-h=1
osd-color='#fbf1c7'
osd-border-color='#282828'
term-osd-bar=yes

geometry=50%:50%
autofit=80%
cursor-autohide=600

##      Subtitles       ##

sub-font='Carlito Bold'
sub-font-size=36
sub-blur=0.1
sub-color=1.0/1.0/1.0/1.0
sub-border-color=0.0/0.0/0.0/1.0
sub-border-size=3.4
sub-margin-x=100
sub-margin-y=50
sub-shadow-color=0.0/0.0/0.0/0.4
sub-shadow-offset=0.5
sub-gauss=1.0
sub-ass-vsfilter-blur-compat=no
sub-fix-timing=yes
sub-auto=fuzzy
blend-subtitles=yes
subs-with-matching-audio=no
demuxer-mkv-subtitle-preroll=yes
slang=ru,rus,russian,en,eng,english,enUS,ukr

##      Screenshots      ##

screenshot-template="%f-%wH.%wM.%wS.%wT-#%#00n"
screenshot-dir="~/Picture/Mpv-screenshots"
screenshot-format=png
screenshot-png-compression=3

##	    Profiles	    ## 

[4k60] # 2160p @ 60fps
profile-desc=4k60
profile-cond=((width ==3840 and height ==2160) and p["estimated-vf-fps"]>=31)
deband=no
##  glsl-shader="~/.config/mpv/shaders/CfL_Prediction.glsl"         # Chroma up+down scaling (Does your GPU have nothing better to do?)

[4k30] # 2160p @ 24-30fps
profile-cond=((width ==3840 and height ==2160) and p["estimated-vf-fps"]<31)
deband=no 
##  glsl-shader="~/.config/mpv/shaders/CfL_Prediction.glsl"         # Chroma up+down scaling (Does your GPU have nothing better to do?)

[Quad-hd60] # 1440p @ 60fps
profile-desc=Quad-hd60
profile-cond=((width ==2560 and height ==1440) and p["estimated-vf-fps"]>=31) 
deband=no
##  glsl-shader="~/.config/mpv/shaders/FSRCNNX_x2_8-0-4-1.glsl"     # Luma upscaling
##  glsl-shader="~/.config/mpv/shaders/ArtCNN_C4F16_CMP.glsl"       # Luma upscaling (High quality)
##  glsl-shader="~/.config/mpv/shaders/ravu-zoom-ar-r3.hook"        # Luma upscaling (Artifacts? Use this)
##  glsl-shader="~/.config/mpv/shaders/CfL_Prediction.glsl"         # Chroma up+down scaling (Does your GPU have nothing better to do?)

[Quad-hd30] # 1440p @ 24-30fps
profile-desc=Quad-hd30
profile-cond=((width ==2560 and height ==1440) and p["estimated-vf-fps"]<31)
deband=no  
##  glsl-shader="~/.config/mpv/shaders/FSRCNNX_x2_8-0-4-1.glsl"     # Luma upscaling
##  glsl-shader="~/.config/mpv/shaders/ArtCNN_C4F16_CMP.glsl"       # Luma upscaling (High quality)
##  glsl-shader="~/.config/mpv/shaders/ravu-zoom-ar-r3.hook"        # Luma upscaling (Artifacts? Use this)
##  glsl-shader="~/.config/mpv/shaders/CfL_Prediction.glsl"         # Chroma up+down scaling (Does your GPU have nothing better to do?)

[full-hd60] # 1080p @ 60fps
profile-desc=full-hd60
profile-cond=((width ==1920 and height ==1080) and not p["video-frame-info/interlaced"] and p["estimated-vf-fps"]>=31)
##  glsl-shader="~/.config/mpv/shaders/FSRCNNX_x2_8-0-4-1.glsl"     # Luma upscaling
##  glsl-shader="~/.config/mpv/shaders/ArtCNN_C4F16_CMP.glsl"       # Luma upscaling (High quality)
##  glsl-shader="~/.config/mpv/shaders/ravu-zoom-ar-r3.hook"        # Luma upscaling (Artifacts? Use this)
##  glsl-shader="~/.config/mpv/shaders/CfL_Prediction.glsl"         # Chroma up+down scaling (Does your GPU have nothing better to do?)

[full-hd30] # 1080p @ 24-30fps
profile-desc=full-hd30
profile-cond=((width ==1920 and height ==1080) and not p["video-frame-info/interlaced"] and p["estimated-vf-fps"]<31) 
##  glsl-shader="~/.config/mpv/shaders/FSRCNNX_x2_8-0-4-1.glsl"     # Luma upscaling
##  glsl-shader="~/.config/mpv/shaders/ArtCNN_C4F16_CMP.glsl"       # Luma upscaling (High quality)
##  glsl-shader="~/.config/mpv/shaders/ravu-zoom-ar-r3.hook"        # Luma upscaling (Artifacts? Use this)
##  glsl-shader="~/.config/mpv/shaders/CfL_Prediction.glsl"         # Chroma up+down scaling (Does your GPU have nothing better to do?)

[hd-60] # 720p @ 60 fps
profile-desc=hd
profile-cond=((width ==1280 and height ==720) and not p["video-frame-info/interlaced"] and p["estimated-vf-fps"]>=31) 
glsl-shader="~/.config/mpv/shaders/FSR.glsl"                        # Luma upscaling
##  glsl-shader="~/.config/mpv/shaders/ArtCNN_C4F16_CMP.glsl"       # Luma upscaling (High quality)
##  glsl-shader="~/.config/mpv/shaders/ravu-zoom-ar-r3.hook"        # Luma upscaling (Artifacts? Use this)
##  glsl-shader="~/.config/mpv/shaders/CfL_Prediction.glsl"         # Chroma up+down scaling (Does your GPU have nothing better to do?)

[hd-30] # 720p @ 24-30fps
profile-desc=hd
profile-cond=((width ==1280 and height ==720) and not p["video-frame-info/interlaced"] and p["estimated-vf-fps"]<31)  
glsl-shader="~/.config/mpv/shaders/FSR.glsl"                        # Luma upscaling
##  glsl-shader="~/.config/mpv/shaders/ArtCNN_C4F16_CMP.glsl"       # Luma upscaling (High quality)
##  glsl-shader="~/.config/mpv/shaders/ravu-zoom-ar-r3.hook"        # Luma upscaling (Artifacts? Use this)
##  glsl-shader="~/.config/mpv/shaders/CfL_Prediction.glsl"         # Chroma up+down scaling (Does your GPU have nothing better to do?)

[sd] # 720x480 @ 30fps 
profile-desc=sd
profile-cond=(width ==720 and height ==480) 
glsl-shader="~/.config/mpv/shaders/FSRCNNX_x2_8-0-4-1.glsl"         # Luma upscaling
##  glsl-shader="~/.config/mpv/shaders/ArtCNN_C4F16_CMP.glsl"       # Luma upscaling (High quality)
##  glsl-shader="~/.config/mpv/shaders/ravu-zoom-ar-r3.hook"        # Luma upscaling (Artifacts? Use this)
##  glsl-shader="~/.config/mpv/shaders/CfL_Prediction.glsl"         # Chroma up+down scaling (Does your GPU have nothing better to do?)

[ld-360] # 640x360 @ 30fps
profile-desc=ld-360
profile-cond=(width ==640 and height ==360)
glsl-shader="~/.config/mpv/shaders/FSRCNNX_x2_8-0-4-1.glsl"         # Luma upscaling
##  glsl-shader="~/.config/mpv/shaders/ArtCNN_C4F16_CMP.glsl"       # Luma upscaling (High quality)
##  glsl-shader="~/.config/mpv/shaders/ravu-zoom-ar-r3.hook"        # Luma upscaling (Artifacts? Use this)
##  glsl-shader="~/.config/mpv/shaders/CfL_Prediction.glsl"         # Chroma up+down scaling (Does your GPU have nothing better to do?)

[ld-240] # 426x240 @ 30fps
profile-desc=ld-240
profile-cond=(width ==426 and height ==240)
glsl-shader="~/.config/mpv/shaders/FSRCNNX_x2_8-0-4-1.glsl"         # Luma upscaling
##  glsl-shader="~/.config/mpv/shaders/ArtCNN_C4F16_CMP.glsl"       # Luma upscaling (High quality)
##  glsl-shader="~/.config/mpv/shaders/ravu-zoom-ar-r3.hook"        # Luma upscaling (Artifacts? Use this)
##  glsl-shader="~/.config/mpv/shaders/CfL_Prediction.glsl"         # Chroma up+down scaling (Does your GPU have nothing better to do?)

##      Protocol Specific Configuration     ##

[protocol.http]
hls-bitrate=max
cache=yes
no-cache-pause

[protocol.https]
profile=protocol.http

[protocol.ytdl]
profile=protocol.http
